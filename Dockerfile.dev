# -----------------------------------------------------------------------------
# Development / Content Creation Dockerfile
# Strategy: "Hot-Reload Content"
#
# This image is designed for active development or content editing.
# It uses the development server (Turbopack) to support live updates.
#
# USAGE:
# You MUST mount the content directory as a volume to enable live editing.
# example: docker run -p 3000:3000 -v $(pwd)/content:/app/content xeocontext-dev
# -----------------------------------------------------------------------------

FROM node:22-alpine
WORKDIR /app

# Install libc for potential native deps compatibility
RUN apk add --no-cache libc6-compat gettext

# Enable pnpm
RUN corepack enable && corepack prepare pnpm@latest --activate

# Copy manifest files first
COPY package.json pnpm-lock.yaml ./

# Install all dependencies (including devDependencies)
RUN pnpm install

# Copy the rest of the application code
COPY . .

# Expose Next.js default port
EXPOSE 3000

# Use development server with Turbopack for fast updates
ENV NODE_ENV=development
CMD ["pnpm", "dev"]
